<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<style>

    fieldset {
        width: 500px;
        height: 400px;
    }

    .field-error{
        border-color: #dc3545;
        color: #dc3545;
    }
</style>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" media="all" th:href="@{/css/main.css}"/>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" th:src="@{/script/main.js}"></script>
<!--    <script type="text/javascript" th:src="@{/script/fileUpload.js}"></script>-->
</head>
<body>
    <form id="frm" th:object="${board}" th:action="@{/board/new}" method="post" enctype="multipart/form-data">
        <div class="field-error" th:errors="*{title}">제목 오류 메시지</div>
        <div class="field-error" th:errors="*{contents}">내용 오류 메시지</div>
        <fieldset class="field">
            <legend>글쓰기</legend>
            <div>
                <tr>
                    <th>제목</th>
                    <td>
                        <input type="text" class="inputForm" style="width: 400px;" th:field="*{title}">
                    </td>
                </tr>
                <br/>
                <tr>
                    <th>내용</th>
                    <td>
                        <input type="text" class="inputForm" rows="3" style="width: 400px; height: 150px;" th:field="*{contents}" >
                    </td>
                </tr>
                <br/>
                <div class="insert">
                    <tr>
                        <td>
                            <button type="button" id="button-add-file" onclick="addFileForm()">파일업로드</button>
                            <div id="file-list"></div>

                        </td>
                    </tr>
                </div>
            </div>
        </fieldset>
            <button type="submit" id="buttonCreate" onclick="createFn()"  >저장</button>
            <button type="button" class="btn btn-primary" th:onclick="|location.href='@{/board/list}'|">목록</button>
    </form>
    <script>
        function delFile(){
                $(this).parent().remove();
        };

        var count = 0
        function addFileForm() {
            html= ""
            html += "<input type='file' name='attachFile[]' />";
            html += "<button class='button-delete-file' onclick='delFile()'>삭제</button></div>";
            count++;
            $("#file-list").append(html);
        }

        function uploadFile(){

            var formData = new FormData();
            var inputFile = $("input[type='file']")
            formData.append("title", $("#title").val());
            formData.append("content", $("#content").val());



            for (var i=0; i < inputFile.length; i++){
                formData.append("uploadFiles", inputFile[i])
            }

            $.ajax({
                url: '/board/new',
                contentType : false,
                processData: false,
                type : "POST",
                data : formData,
                success: function(returnData) {
                    console.log(returnData);
                },
            });

        }

    </script>
</body>

</html>