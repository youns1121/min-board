<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.minboard.mapper.UploadFileMapper">

    <resultMap id="UploadFileDtoResultMap" type="UploadFileDto">
        <result property="originalFileName" column="original_file_name"/>
        <result property="storeFileName" column="store_file_name"/>
        <result property="extensionName" column="extension_name"/>
        <result property="storeFileSize" column="store_file_size"/>
        <result property="storeFilePath" column="store_file_path"/>
        <result property="createTime" column="create_time"/>
        <result property="boardId" column="board_id"/>
    </resultMap>

    <resultMap id="UploadFileUpdateVoResultMap" type="UploadFileUpdateVo">
        <result property="originalFileName" column="original_file_name"/>
        <result property="storeFileName" column="store_file_name"/>
        <result property="extensionName" column="extension_name"/>
        <result property="storeFileSize" column="store_file_size"/>
        <result property="storeFilePath" column="store_file_path"/>
        <result property="createTime" column="create_time"/>
        <result property="boardId" column="board_id"/>
    </resultMap>


    <!--- 생성하기  -->
    <insert id="insertFileInfoList"
            parameterType="java.util.List"
            useGeneratedKeys ="true"
            keyProperty="id">

        INSERT INTO
            upload_file(
                        store_file_name,
                        original_file_name,
                        extension_name,
                        store_file_size,
                        store_file_path,
                        board_id,
                        create_time
        )VALUES
        <foreach collection="list" item="item" separator=",">
            (
                         #{item.storeFileName},
                         #{item.originalFileName},
                         #{item.extensionName},
                         #{item.storeFileSize},
                         #{item.storeFilePath},
                         #{item.boardId},
                         #{item.createTime}
            )
        </foreach>
    </insert>

    <insert id="updateFileInfoList"
            parameterType="java.util.List"
            useGeneratedKeys ="true">

        INSERT INTO
            upload_file(
                store_file_name,
                original_file_name,
                extension_name,
                store_file_size,
                store_file_path,
                board_id,
                create_time
        )VALUES
            <foreach collection="list" item="item" separator=",">
                (
                    #{item.storeFileName},
                    #{item.originalFileName},
                    #{item.extensionName},
                    #{item.storeFileSize},
                    #{item.storeFilePath},
                    #{item.boardId},
                    #{item.createTime}
                )
            </foreach>
    </insert>

    <select id="getUploadFileList" resultType="UploadFileDto" resultMap="UploadFileDtoResultMap">
        SELECT
                id,
                original_file_name,
                store_file_name,
                store_file_path,
                store_file_size,
                extension_name,
                board_id

        FROM
                upload_file

        WHERE
                board_id = #{boardId}
    </select>

    <select id="findByUploadFile" resultType="UploadFileDto" resultMap="UploadFileDtoResultMap">
        SELECT
                id,
                original_file_name,
                store_file_name,
                extension_name,
                store_file_size,
                store_file_path,
                create_time,
                board_id
        FROM
                upload_file

        WHERE
                id = #{id}
    </select>

    <select id="getUploadFileUpdateList" resultType="UploadFileUpdateVo" resultMap="UploadFileUpdateVoResultMap"  >
        SELECT
                id,
                original_file_name,
                store_file_name,
                extension_name,
                store_file_size,
                store_file_path,
                create_time,
                board_id

        FROM
                upload_file
        WHERE
                board_id = #{id}
    </select>

    <delete id="deleteFile" parameterType="int">
        DELETE

        FROM
                upload_file
        WHERE
                id = #{id}
    </delete>

    <delete id="deleteAllFile" parameterType="int">
        DELETE

        FROM
            upload_file
        WHERE
            board_id = #{id}
    </delete>

</mapper>